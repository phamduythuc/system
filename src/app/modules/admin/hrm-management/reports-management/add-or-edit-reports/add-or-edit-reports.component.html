<ng-container *transloco="let t">
  <div class="header border-b flex justify-between items-center pb-3">
    <div class="text-2xl font-bold card-title capitalize">
      {{
        (dialogId ? "common.title.edit" : "common.title.create")
          | transloco
            : { screenName: "hrm-management.reports.title" | transloco }
      }}
    </div>
    <div>
      <button
        mat-icon-button
        class="hover:bg-slate-100"
        (click)="dialogRef.close()"
      >
        <mat-icon
          svgIcon="heroicons_outline:x"
          title="Edit"
          class="icon-size-5"
        ></mat-icon>
      </button>
    </div>
  </div>
  <!--    content-->
  <div class="content mt-6" [formGroup]="formGroup">
    <div class="field flex mb-4 gap-5">
      <div class="w-1/2 flex flex-wrap">
        <label class="w-full font-medium required" for="name">{{
          "hrm-management.reports.form.name" | transloco
        }}</label>
        <div class="input w-full">
          <mat-form-field class="fuse-mat-no-subscript w-full">
            <input
              class="w-full"
              id="name"
              [placeholder]="'hrm-management.reports.form.name' | transloco"
              formControlName="name"
              matInput
              [readonly]="readonly"
            />
          </mat-form-field>
          <app-error-message
            [control]="formGroup.get('name')"
            [name]="'hrm-management.reports.form.name' | transloco"
          ></app-error-message>
        </div>
      </div>

      <div class="w-1/2 flex flex-wrap">
        <mat-label class="w-full font-medium required" for="code">{{
          "hrm-management.reports.form.code" | transloco
        }}</mat-label>
        <div class="input w-full">
          <mat-form-field class="fuse-mat-no-subscript w-full">
            <input
              class="w-full"
              id="code"
              [placeholder]="'hrm-management.reports.form.code' | transloco"
              formControlName="code"
              matInput
              [readonly]="readonly"
            />
          </mat-form-field>
          <app-error-message
            [control]="formGroup.get('code')"
            [name]="'hrm-management.reports.form.code' | transloco"
          ></app-error-message>
        </div>
      </div>
    </div>

    <div class="field flex mb-4 items-center gap-5">
      <button
        mat-raised-button
        color="primary"
      >
        <mat-icon
          class="icon-size-5 mr-2"
          svgIcon="heroicons_outline:paper-clip"
        ></mat-icon>

        <label for="file">Template</label>
      </button>
      <input
        type="file"
        id="file"
        name="file"
        class="hidden"
        (change)="uploadFile($event)"
      />
      <label for="file">{{
        (this.detailsData?.templateName
          ? this.detailsData?.templateName
          : "Upload file"
        ) | transloco
      }}</label>
    </div>
    <div class="field flex mb-4 gap-5" >
      <div class="w-1/2 flex flex-wrap gap-5">
        <span *ngIf="formGroup.value.templatePath"
          class="cursor-pointer italic underline text-[#4f9cad]"
          (click)="download(formGroup.value.templatePath,'1')"
          >{{
            "hrm-management.reports.detail.downloadTemplate" | transloco
          }}</span
        >
        <!-- <span class="cursor-pointer italic underline text-[#4f9cad]">{{
          "hrm-management.reports.detail.viewReports" | transloco
        }}</span> -->
        <span *ngIf="formGroup.value.templateName"
          class="cursor-pointer italic underline text-[#4f9cad]"
          (click)="download(detailsData.id,'2')"
          >{{
            "hrm-management.reports.detail.downloadReports" | transloco
          }}</span
        >
      </div>
    </div>

    <div class="field flex mb-4 gap-5">
      <div class="w-full flex flex-wrap">
        <label class="w-full font-medium required" for="description">{{
          "hrm-management.reports.form.description" | transloco
        }}</label>
        <div class="input w-full">
          <mat-form-field class="fuse-mat-no-subscript w-full">
            <textarea
              class="w-full"
              id="description"
              [placeholder]="
                'hrm-management.reports.form.description' | transloco
              "
              formControlName="description"
              matInput
              [readonly]="readonly"
            ></textarea>
          </mat-form-field>
          <app-error-message
            [control]="formGroup.get('description')"
            [name]="'hrm-management.reports.form.description' | transloco"
          ></app-error-message>
        </div>
      </div>
    </div>
    <div class="data-table w-full mt-4 h-3/5">
      <div class="sm:col-span-4">
        <div class="header flex justify-between items-center pb-3">
          <div class="text-2xl font-bold card-title">
            {{ "hrm-management.reports.detail.listSheet" | transloco }}
          </div>
          <button mat-raised-button color="primary" (click)="addNewRow()">
            <mat-icon
              class="icon-size-6"
              svgIcon="heroicons_outline:plus"
            ></mat-icon>
            {{ "effort.add" | transloco }}
          </button>
        </div>
      </div>

      <app-list-param-reports [data]="detailsData?.listSheet" [addRow]="random" (callback)="handleDataListParam($event)"></app-list-param-reports>

      <!-- <ng-container>
        <div
          class="border mb-8"
          *ngFor="let item of detailsData.listSheet; let index = index"
        >
          <div
            class="border-2 relative pt-5 pb-2 px-5 flex-wrap flex gap-y-4"
            formArrayName="listSheet"
          >
            <p
              class="absolute -top-5 left-5 text-[21px] font-bold z-[100] bg-[#ffffff] px-5"
            >
              Sheet {{ index + 1 }}
            </p>
{{item | json}}

            <div class="field flex w-full" [formGroupName]="index">
              <label class="w-1/6 font-medium flex items-center required">{{
                "common.name" | transloco
              }}</label>
              <div class="input w-5/6">
                <mat-form-field
                  class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
                >
                  <input
                    type="text"
                    matInput
                    [formControlName]="name"
                    required
                    placeholder="{{ 'common.name' | transloco }}"
                    class="p-0"
                  />
                </mat-form-field>
                <app-error-message
                  [control]="efforts.controls[index].get('name')"
                  [name]="'common.name' | transloco"
                >
                </app-error-message>
              </div>
            </div>


            <div class="field flex w-1/2" [formGroupName]="index">
              <label class="w-1/3 font-medium flex items-center required">{{
                'hrm-management.reports.form.startRow' | transloco
              }}</label>
              <div class="input w-2/3">
                <mat-form-field
                  class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
                >
                  <input
                    type="text"
                    matInput
                    [formControlName]="startRow"
                    required
                    placeholder="{{
                      'hrm-management.reports.form.startRow' | transloco
                    }}"
                    class="p-0"
                  />
                </mat-form-field>
                <app-error-message
                  [control]="efforts.controls[index].get('startRow')"
                  [name]="'hrm-management.reports.form.startRow' | transloco"
                >
                </app-error-message>
              </div>
            </div>


            <div class="field flex w-1/2" [formGroupName]="index">
              <label class="w-1/3 font-medium flex items-center required">{{
                "hrm-management.reports.form.startCol" | transloco
              }}</label>
              <div class="input w-2/3">
                <mat-form-field
                  class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
                >
                  <input
                    type="text"
                    matInput
                    [formControlName]="startCol"
                    required
                    placeholder="{{
                      'hrm-management.reports.form.startCol' | transloco
                    }}"
                    class="p-0"
                  />
                </mat-form-field>
                <app-error-message
                  [control]="efforts.controls[index].get('startCol')"
                  [name]="'hrm-management.reports.form.startCol' | transloco"
                >
                </app-error-message>
              </div>
            </div>


            <div class="field flex w-full" [formGroupName]="index">
              <label class="w-1/6 font-medium flex items-center required">{{
                "hrm-management.reports.form.sql" | transloco
              }}</label>
              <div class="input w-5/6">
                <mat-form-field
                  class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
                >
                  <textarea
                    matInput
                    [formControlName]="sql"
                    required
                    placeholder="{{
                      'hrm-management.reports.form.sql' | transloco
                    }}"
                    class="py-2 m-0"
                  >
                  </textarea>
                </mat-form-field>
                <app-error-message
                  [control]="efforts.controls[index].get('sql')"
                  [name]="'hrm-management.reports.form.sql' | transloco"
                >
                </app-error-message>
              </div>
            </div>


            <div class="field flex w-full" [formGroupName]="index">
              <label class="w-1/6 font-medium flex items-center">{{
                "hrm-management.reports.form.comment" | transloco
              }}</label>
              <div class="input w-5/6">
                <mat-form-field
                  class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
                >
                  <textarea
                    matInput
                    [formControlName]="comment"
                    required
                    placeholder="{{
                      'hrm-management.reports.form.comment' | transloco
                    }}"
                    class="py-2 m-0"
                  >
                  </textarea>
                </mat-form-field>
                <app-error-message
                  [control]="efforts.controls[index].get('comment')"
                  [name]="'hrm-management.reports.form.comment' | transloco"
                >
                </app-error-message>
              </div>
            </div>




            <div class="field flex w-full justify-end" [formGroupName]="index">
              <div class="input w-6/6">
                <button
                  mat-icon-button
                  class="mat-focus-indicator mat-icon-button mat-button-base ng-star-inserted"
                  (click)="deleteRow(index)"
                >
                  <mat-icon
                    class="icon-size-5"
                    svgIcon="heroicons_outline:trash"
                    title="Close"
                  ></mat-icon>
                </button>
              </div>
            </div>
          </div>
        </div>
      </ng-container> -->
    </div>
  </div>

  <!--    footer-->

  <div class="footer mt-6 flex justify-end">
    <button mat-raised-button class="mr-3" (click)="dialogRef.close()">
      <mat-icon
        class="icon-size-5 mr-2"
        svgIcon="heroicons_outline:x"
      ></mat-icon>
      <span>{{ t("button.cancel") }}</span>
    </button>
    <button
      mat-raised-button
      color="primary"
      [disabled]="formGroup.invalid || !listSheet.validate"
      (click)="formGroup.valid && save()"
    >
      <mat-icon
        class="icon-size-5 mr-2"
        svgIcon="heroicons_outline:check"
      ></mat-icon>
      <span>{{ t("button.save") }}</span>
    </button>
  </div>
</ng-container>
