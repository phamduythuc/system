<div class="border mb-8" *ngFor="let item of data; let i = index">
  <div class="border-2 relative pt-5 pb-2 px-5 flex-wrap flex gap-y-5">
    <p
      class="absolute -top-5 left-5 text-[21px] font-bold z-[100] bg-[#ffffff] px-5"
    >
      Sheet {{ i + 1 }}
    </p>

    <!-- Name -->

    <div class="field flex w-full">
      <label class="w-1/6 font-medium flex items-center required">{{
        "common.name" | transloco
      }}</label>
      <div class="input w-5/6">
        <mat-form-field
          class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
        >
          <input
            type="text"
            matInput
            [(ngModel)]="item.name"
            required
            placeholder="{{ 'common.name' | transloco }}"
            class="p-0"
          />
        </mat-form-field>
        <!-- <app-error-message
          [control]="efforts.controls[index].get('name')"
          [name]="'common.name' | transloco"
        >
        </app-error-message> -->
      </div>
    </div>

    <!-- Start row -->

    <div class="field flex w-full">
        <div class="flex w-1/2">
            <label class="w-1/3 font-medium flex items-center required">{{
              "hrm-management.reports.form.startRow" | transloco
            }}</label>
            <div class="input w-2/3">
              <mat-form-field
                class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
              >
                <input
                  type="text"
                  matInput
                  [(ngModel)]="item.startRow"
                  required
                  placeholder="{{
                    'hrm-management.reports.form.startRow' | transloco
                  }}"
                  class="p-0"
                />
              </mat-form-field>
              <!-- <app-error-message
                [control]="efforts.controls[index].get('startRow')"
                [name]="'hrm-management.reports.form.startRow' | transloco"
              >
              </app-error-message> -->
            </div>
          </div>

          <div class=" flex w-1/2 ml-7">
            <label class="w-1/3 font-medium flex items-center required">{{
              "hrm-management.reports.form.startCol" | transloco
            }}</label>
            <div class="input w-2/3">
              <mat-form-field
                class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
              >
                <input
                  type="text"
                  matInput
                  [(ngModel)]="item.startCol"
                  required
                  placeholder="{{
                    'hrm-management.reports.form.startCol' | transloco
                  }}"
                  class="p-0"
                />
              </mat-form-field>
              <!-- <app-error-message
                [control]="efforts.controls[index].get('startCol')"
                [name]="'hrm-management.reports.form.startCol' | transloco"
              >
              </app-error-message> -->
            </div>
          </div>
    </div>

    <!-- Start col -->

    

    <!-- SQL -->

    <div class="field flex w-full items-start">
      <label class="w-1/6 font-medium flex items-center required">{{
        "hrm-management.reports.form.sql" | transloco
      }}</label>
      <div class="input w-5/6">
        <mat-form-field
          class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
        >
          <textarea
            matInput
            [(ngModel)]="item.sql"
            required
            placeholder="{{ 'hrm-management.reports.form.sql' | transloco }}"
            class="py-2 m-0 min-h-[70px]"
          >
          </textarea>
        </mat-form-field>
        <!-- <app-error-message
          [control]="efforts.controls[index].get('sql')"
          [name]="'hrm-management.reports.form.sql' | transloco"
        >
        </app-error-message> -->
      </div>
    </div>

    <!-- Comment  -->

    <div class="field flex w-full items-start">
      <label class="w-1/6 font-medium flex items-center">{{
        "hrm-management.reports.form.comment" | transloco
      }}</label>
      <div class="input w-5/6">
        <mat-form-field
          class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
        >
          <textarea
            matInput
            [(ngModel)]="item.comment"
            required
            placeholder="{{
              'hrm-management.reports.form.comment' | transloco
            }}"
            class="py-2 m-0 min-h-[70px]"
          >
          </textarea>
        </mat-form-field>
        <!-- <app-error-message
          [control]="efforts.controls[index].get('comment')"
          [name]="'hrm-management.reports.form.comment' | transloco"
        >
        </app-error-message> -->
      </div>
    </div>

    <!-- List param  -->

    <div class="field w-full">
      <label class="w-1/6 font-medium flex items-center">{{
        "hrm-management.reports.form.listParam" | transloco
      }}</label>

      <app-data-table
        [rows]="item.listParam || []"
        [columns]="columns"
        [paginate]="false"
        [rowTemplate]="rowTemplate"
        (action)="actionClick($event)"
        (pageChange)="changePage($event)"
      >
        <ng-template #rowTemplate let-row="row" let-column="column" let-index="index">
          <ng-container [ngSwitch]="column.columnDef">
            <ng-container *ngSwitchDefault>{{
              row[column.columnDef]
            }}</ng-container>

            

              <ng-container *ngSwitchCase="'paramType'">
                <mat-form-field class="fuse-mat-no-subscript w-full">
             
                    <mat-select [(ngModel)]="row['paramType']" (ngModelChange)="changeParamType(index,i)">
                      <mat-option
                        *ngFor="let r of list_param"
                        [value]="r.code"
                      >
                        {{ r.name }}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
              </ng-container>

            <ng-container *ngSwitchCase="'value'">
              <mat-form-field
                class="fuse-mat-no-subscript w-full mt-4 sm:mt-0 bg-card"
              >
                <input
                  [type]="row['typeInput']"
                  matInput
                  [(ngModel)]="row['value']"
                  required
                  placeholder="{{
                    'hrm-management.reports.form.startCol' | transloco
                  }}"
                  class="p-0"
                />
              </mat-form-field>
            </ng-container>

            <ng-container *ngSwitchCase="'actionCustom'">
              <button
                mat-icon-button
                class="mat-focus-indicator mat-icon-button mat-button-base ng-star-inserted"
                (click)="deleteRow(index)"
              >
                <mat-icon
                  class="icon-size-5"
                  svgIcon="heroicons_outline:trash"
                  title="Close"
                ></mat-icon>
              </button>
            </ng-container>
          </ng-container>
        </ng-template>
      </app-data-table>
    </div>

    <!-- Delete  -->

    <div class="field flex w-full justify-end">
      <div class="input w-6/6">
        <button
          mat-icon-button
          class="mat-focus-indicator mat-icon-button mat-button-base ng-star-inserted"
          (click)="deleteRow(i)"
        >
          <mat-icon
            class="icon-size-5"
            svgIcon="heroicons_outline:trash"
            title="Close"
          ></mat-icon>
        </button>
      </div>
    </div>
  </div>
</div>
